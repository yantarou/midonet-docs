<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:exsl="http://exslt.org/common" xmlns:ng="http://docbook.org/docbook-ng" xmlns:fb="http://ogp.me/ns/fb#"><head>
<link href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet"/>
<title>Chapter 11. Handling fragmented packets - MidoNet Operation Guide
   - 2015.03-rev1</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"/><meta name="mavenGroupId" content="org.midonet"/><meta name="mavenArtifactId" content="midonet-docs-operation-guide-en"/><meta name="mavenVersionId" content="2015.03-rev1"/><link rel="home" href="index.html" title="MidoNet Operation Guide"/><link rel="up" href="index.html" title="MidoNet Operation Guide"/><link rel="prev" href="rule_chain_example.html" title="L2 address mask rule chain example"/><link rel="next" href="resource_protection.html" title="Chapter 12. MidoNet resource protection"/><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta name="git-sha" content="0dc04ca03c7e6c2af13c870f411d92ad058d31e2"/><meta name="buildTime" content="2015-05-11T16:00:45+09:00"/><script type="text/javascript">
            //The id for tree cookie
            var treeCookieId = "treeview-book_operation_guide_en";
            var language = "en";
            var w = new Object();
            //Localization
            txt_filesfound = 'Results';
            txt_enter_at_least_1_char = "You must enter at least one character.";
            txt_browser_not_supported = "Please enable JavaScript.";
            txt_please_wait = "Please wait. Search in progress...";
            txt_results_for = "Results for: ";
        </script><style type="text/css">
            input {
            margin-bottom: 5px;
            margin-top: 2px;
            }

            .folder {
            display: block;
            height: 22px;
            padding-left: 20px;
            background: transparent url(../common/jquery/treeview/images/folder.gif) 0 0px no-repeat;
            }
            
        </style><link rel="shortcut icon" href="../favicon.ico" type="image/x-icon"/><link rel="stylesheet" type="text/css" href="../common/css/positioning.css"/><link rel="stylesheet" type="text/css" href="../common/css/custom.css"/><!--[if IE]>
	<link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
	<![endif]--><link rel="stylesheet" type="text/css" href="../common/jquery/theme-redmond/jquery-ui-1.8.2.custom.css"/><link rel="stylesheet" type="text/css" href="../common/jquery/treeview/jquery.treeview.css"/><script type="text/javascript" src="http://code.jquery.com/jquery-1.11.0.min.js"><!----></script><script type="text/javascript" src="../common/jquery/jquery-ui-1.8.2.custom.min.js"><!----></script><script type="text/javascript" src="../common/jquery/jquery.cookie.js"><!----></script><script type="text/javascript" src="../common/jquery/treeview/jquery.treeview.min.js"><!----></script><link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/qtip2/2.2.0/jquery.qtip.min.css"/><script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.0/jquery.qtip.min.js"><!--jQuery plugin for glossary popups. --></script><script type="text/javascript" src="search/htmlFileList.js"><!----></script><script type="text/javascript" src="search/htmlFileInfoList.js"><!----></script><script type="text/javascript" src="search/nwSearchFnt.js"><!----></script><script type="text/javascript" src="search/stemmers/en_stemmer.js"><!--//make this scalable to other languages as well.--></script><script type="text/javascript" src="search/index-1.js"><!----></script><script type="text/javascript" src="search/index-2.js"><!----></script><script type="text/javascript" src="search/index-3.js"><!----></script><script type="text/javascript">
	    var _gaq = _gaq || [];
	    _gaq.push(['_setAccount', 'UA-56283377-4']);
	    
	    _gaq.push(['_setDomainName', '.midonet.org']);	        
	        </script><script type="text/javascript" src="../common/ga.js"><!----></script></head><body><div id="header"><a onclick="_gaq.push(['_trackEvent', 'Header', 'logo', 'click', 1]);" target="_blank" href="http://www.midonet.org"><img src="../common/images/midonet-logo.png" alt="MidoNet Documentation" width="157" height="47"/></a><h1>Chapter 11. Handling fragmented packets</h1><div id="navheader" align="right"><!----><table class="navLinks"><tr><td><a id="showHideButton" onclick="showHideToc(); _gaq.push(['_trackEvent', 'Header', 'show/hide', 'click', 1]);" class="pointLeft" title="Hide TOC tree">Sidebar
                            </a></td><td><a accesskey="p" class="navLinkPrevious" onclick="_gaq.push(['_trackEvent', 'Header', 'prevLink', 'click', 1]);" tabindex="5" href="rule_chain_example.html">Prev</a> 
				  |
                                    <a accesskey="n" class="navLinkNext" onclick="_gaq.push(['_trackEvent', 'Header', 'nextLink', 'click', 1]);" tabindex="5" href="resource_protection.html">Next</a></td></tr></table></div></div><div id="toolbar" class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"><div id="toolbar-left"><p class="breadcrumbs"><a href="http://docs.midonet.org/">MidoNet Manuals</a><a href="index.html">MidoNet Operation Guide
   - 2015.03-rev1</a></p><a onclick="_gaq.push(['_trackEvent', 'Header', 'pdfDownload', 'click', 1]);" alt="Download a pdf of this document" class="pdficon" href="../MidoNet_Operation_Guide_EN_2015.03-rev1.pdf"><img src="../common/images/pdf.png"/></a><div id="gplusone"><a id="AskOOLink1" href="http://wiki.midonet.org/Mailing%20lists%20and%20IRC" target="_blank" title="Questions? Discuss on Mailing Lists or Chat."><i class="icon-question"><!----></i></a>  
        <a id="logABugLink1" href="https://midonet.atlassian.net/browse/MND/" target="_blank" title="Found an error? Report a bug."><i class="icon-bug"><!----></i></a></div></div></div><div id="content"><div class="chapter"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="handling_fragmented_packets"> </a>Chapter 11. Handling fragmented packets</h2></div></div></div><div class="toc"><p><strong>Contents</strong></p><dl><dt><span class="section"><a href="handling_fragmented_packets.html#_definitions_and_allowed_values">Definitions and allowed values</a></span></dt><dt><span class="section"><a href="handling_fragmented_packets.html#_fragmented_packets_rule_chain_creation_example">Fragmented packets rule chain creation example</a></span></dt><dt><span class="section"><a href="handling_fragmented_packets.html#_non_fragmented_and_fragmented_packets">Non-Fragmented and Fragmented Packets</a></span></dt><dt><span class="section"><a href="handling_fragmented_packets.html#_fragmented_and_non_fragmented_packets_with_different_destinations">Fragmented and Non-Fragmented Packets with Different Destinations</a></span></dt></dl></div><p>If you observe that MidoNet is encountering fragmented packets, this section
describes how you can handle this situation.</p><p>You can configure IP fragment matching in rules to configure how fragmented
packets are handled when L4 rules are applied in the virtual topology. This
feature allows IP fragments to pass through the virtual topology instead of
being dropped. With this feature implementation, you have the following options:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">If you are writing an L2/L3 firewall, you can be IP fragment agnostic: no
special handling of IP fragments is required. (L3 NAT handles IP fragments
correctly.)</li><li class="listitem">If you are writing an L4 firewall, you can specify special handling for IP
fragments.</li></ul></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="_definitions_and_allowed_values"> </a>Definitions and allowed values</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">header = the Condition matches non-fragmented packets AND header fragments.
header refers to a non-fragmented packet or to the first fragment (the header
fragment) of a fragmented packet. The header fragment is the only one whose IPv4
"fragment offset" field is set to zero. header is the only allowed value if the
rule’s Condition matches L4 fields OR the rule is dynamic (that is, port
modifying) DNAT or SNAT</li><li class="listitem">nonheader = the Condition matches only non-header fragments. nonheader refers
to the second and subsequent fragments.</li><li class="listitem">any = the Condition matches any fragment AND non-fragmented packets.</li><li class="listitem">unfragmented = the Condition matches any non-fragmented packet.</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../common/images/admon/note.png"/></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>If the fragment-policy argument is not set, then it is treated like the setting
is any, unless header is the only allowed value.</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../common/images/admon/note.png"/></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>When you run OpenStack Icehouse against MidoNet with the Condition semantics
described above, the handling of fragments will change as follows:</p><p>Instead of dropping fragments when they pass through L4 rules, these fragments
will be ignored by L4 rules, and therefore, may potentially allow the packets
through filters.</p><p>A single L4 flow may generate up to two different flows: one to handle
non-header fragments, another to handle all other packets.</p></td></tr></table></div></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="_fragmented_packets_rule_chain_creation_example"> </a>Fragmented packets rule chain creation example</h2></div></div></div><p>Create a chain (this creates a rule chain with an alias, "chain0" in the
example, pointing to the chain created):</p><pre class="screen">create chain name chain0</pre><p>Add a rule to the chain that drops header fragments:</p><pre class="screen">chain chain0 add rule fragment-policy header pos 2 header type drop</pre><p><span class="strong"><strong>Example 1 Firewall, Does Not Account for Fragmented Packets</strong></span></p><p>The example below only handles non-fragmented packets. These are the firewall
rules you start with before you decide to handle fragmented packets.</p><p>Initially, you design your firewall to:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Only allow incoming TCP port 80 (HTTP) traffic</li><li class="listitem">Drop all other packets</li></ul></div><p>Without addressing fragmented packets, you create a rule chain with the
following two rules:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">Rule at position 1</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">By default, this rule matches only non-fragmented packets and header
fragments.</li><li class="listitem"><p class="simpara">ACCEPTs packets with protocol=TCP and destination=80.</p><pre class="screen">midonet&gt; chain chain0 add rule ethertype 2048 src 0.0.0.0/0 proto 6 in-ports router2:port0 dst-port 80 pos 1 type accept</pre></li></ul></div></li><li class="listitem"><p class="simpara">Rule at position 2</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">DROPs all packets.</p><pre class="screen">midonet&gt; chain chain0 add rule ethertype 2048 src 0.0.0.0/0 dst 0.0.0.0/0 in-ports router2:port0 pos 2 type drop</pre></li></ul></div></li></ul></div><pre class="screen">midonet&gt; chain chain0 list rule
rule rule0 ethertype 2048 src 0.0.0.0/0 proto 6 tos 0 dst-port 80 in-ports router2:port0 pos 1 type accept
rule rule1 ethertype 2048 src 0.0.0.0/0 dst 0.0.0.0/0 proto 0 tos 0 in-ports router2:port0 pos 2 type drop</pre><p>With the above rule chain, MidoNet handles fragmented packet with the
destination TCP port 80 as follows:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">The first half of the packet, which contains the TCP header, reaches the rule
at position 1, and is accepted.</li><li class="listitem">However, the second half of the fragmented, which does not have the
destination port, reaches the rule at position 1, does not match the rule’s
condition, and is dropped. This means the fragmented packets do not reach the
Web server.</li></ul></div><p><span class="strong"><strong>Example 2 Firewall, Addresses Fragmented Packets</strong></span></p><p>To address this problem, MidoNet provides a mechanism to handle the fragmented
packets. This mechanism allows the fragmented packets to reach their
destination, as shown in the following example. The drawing below simply depicts
a whole, non-fragmented packet and a fragmented packet that consists of two
parts, a header and non-header.</p><div class="informalfigure"><div class="mediaobject"><img src="figures/1/images/packet_fragments.png" alt="packet fragments"/></div></div></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="_non_fragmented_and_fragmented_packets"> </a>Non-Fragmented and Fragmented Packets</h2></div></div></div><p>For this example, consider the following packets:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Non-fragmented packet with the destination, TCP port 80</li><li class="listitem">Fragmented packet with the destination, TCP port 80</li><li class="listitem">Non-fragmented packet with the destination, TCP port 72</li><li class="listitem">Fragmented packet with the destination, TCP port 72</li></ul></div><div class="informalfigure"><div class="mediaobject"><img src="figures/1/images/packet_fragments_multiple_ports.png" alt="packet fragments multiple ports"/></div></div></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="_fragmented_and_non_fragmented_packets_with_different_destinations"> </a>Fragmented and Non-Fragmented Packets with Different Destinations</h2></div></div></div><p>Given the above packets and the rule in example 1, MidoNet processes the packets
as follows:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Packet 1 matches the rule in position 1 and is accepted.</li><li class="listitem">The header part of packet 2 matches the rule in position 1 and is accepted;
the non-header fragment, which doesn’t contain the destination, does not match
the rule and is dropped.</li><li class="listitem">Packet 3’s destination does not match the rule in position 1 and is dropped,
same thing for the header part of packet 4. The non-header part of packet 4 does
not contain destination information and is dropped.</li></ul></div><p>The first objective is to accept the part of the packet fragments that contains
the headers. To do this, you create the same rule at position 1. The change is
to add a new rule at position 2, to drop all packets that contain TCP/UDP headers.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">Rule at position 1</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">By default, this rule matches only non-fragmented packets and header
fragments.</li><li class="listitem"><p class="simpara">ACCEPTs packets from in-ports=router2:port0 with protocol=TCP and
destination=80.</p><pre class="screen">midonet&gt; chain chain18 add rule ethertype 2048 src 0.0.0.0/0 proto 6 in-ports router2:port0 dst-port 80 pos 1 type accept</pre></li></ul></div></li><li class="listitem"><p class="simpara">Rule at position 2</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">Drop packets that contain TCP/UDP headers</p><pre class="screen">midonet&gt; chain chain18 add rule ethertype 2048 src 0.0.0.0/0 in-ports router2:port0 fragment-policy header pos 2 type drop</pre></li></ul></div></li><li class="listitem"><p class="simpara">Rule at position 3</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">Accept all other packets</p><pre class="screen">midonet&gt; chain chain18 add rule ethertype 2048 src 0.0.0.0/0 in-ports router2:port0 dst 0.0.0.0/0 pos 3 type accept</pre></li></ul></div></li></ul></div><p>Look at the packets in the above figure, starting with the packets destined for
port 72, and how they the progress through this new rule chain:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Packet 3’s destination is port 72, not port 80, does not match the rule in
position number 1, and continues to the rule at position number 2.</li><li class="listitem">Packet 3 contains a TCP header and therefore matches the rule at position
number 2 and isdropped.</li><li class="listitem">The header fragment of packet 4 contains a destination of port 72, does not
match the rule at position 1 and continues to the rule at position number 2.</li><li class="listitem">This fragment contains a TCP header, matches the rule at position number 2,
and is dropped.</li><li class="listitem">The non-header fragment of packet 4 does not contain a header (and therefore,
has no destination information), does not match the rule at position 1, and
continues to the rule at position 2.</li><li class="listitem">This non-header packet fragment does not contain a TCP/UDP header, does not
match the rule at position 2, and continues to the rule at position 3.</li><li class="listitem">The rule at position 3 accepts all packets that reach it and accepts this
packet fragment. Because this packet does not have any associated header
information it will not be reassembled and sent to an application and will
eventually be dropped.</li></ul></div><p>Looking at packets 1 and 2:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Packet 1 is destined for TCP port 80, matches the rule at position 1, and is
accepted.</li><li class="listitem">For packet 2, the packet fragment with the header contains a destination of
TCP port 80, matches the rule at position 1, and is accepted.</li><li class="listitem">The non-header packet fragment of packet number 2 does not contain a header,
does not match the rule at position number 1, and continues to the rule at
position number 2.</li><li class="listitem">This non-header packet fragment does not contain a TCP/UDP header, therefore
does not match the rule at position number 2, is not dropped, and continues to
the rule at position number 3.</li><li class="listitem">The rule at position number 3 accepts all packets, so this packet fragment is
accepted.</li></ul></div><p>This change allows non-header fragments to get past both the rules at positions
1 and 2, and exit the chain with an ACCEPT. With this change, the firewall now
lets all non-header fragments through, but you decided that the level of risk is
acceptable and are just trying to fix the broken HTTP flows. This is not a
problem, as an unwanted nonheader fragment will be discarded if the
corresponding header fragment is never received.</p></div></div><script type="text/javascript" src="../common/main.js"><!----></script><div class="logabug" style="text-align: center"><a id="AskOOLink2" href="http://wiki.midonet.org/Mailing%20lists%20and%20IRC" target="_blank"><i class="icon-question"><!----></i>Questions? Discuss on Mailing Lists or Chat.</a><br/><a id="logABugLink2" href="https://midonet.atlassian.net/browse/MND/" target="_blank"><i class="icon-bug"><!----></i>Found an error? Report a bug.</a></div><hr/><div id="disqus_thread"><script type="text/javascript">
	      if(window.location.protocol.substring(0,4) == 'http'){
	        var disqus_shortname = 'midonet';
	      
	        var disqus_identifier = 'book_operation_guide_en2015.03-rev1handling_fragmented_packets';
	      
	      }
	    </script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><script type="text/javascript" src="../common/comments.js"><!----></script></div><hr/><div class="legal"><a href="index.html">Legal notices</a></div></div><div><div id="leftnavigation" style="padding-top:3px; background-color:white;"><div id="tabs"><ul><li><a href="#treeDiv" tabindex="1"><span class="contentsTab">Contents</span></a></li><li><a href="#searchDiv" tabindex="1"><span class="searchTab">Search</span></a></li></ul><div id="treeDiv"><img src="../common/images/loading.gif" alt="loading table of contents..." id="tocLoading" style="display:block;"/><div id="ulTreeDiv" style="display:none" class="thisisthat"><ul id="tree" class="filetree"><li tabindex="2"><span class="file"><a href="preface.html">Preface</a></span><ul><li tabindex="2"><span class="file"><a href="preface.html#_conventions">Conventions</a></span><ul><li tabindex="2"><span class="file"><a href="preface.html#_notices">Notices</a></span></li><li tabindex="2"><span class="file"><a href="preface.html#_command_prompts">Command prompts</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="configuring_uplinks.html">1. Configuring uplinks</a></span><ul><li tabindex="2"><span class="file"><a href="bgp_setup.html">BGP Setup</a></span><ul><li tabindex="2"><span class="file"><a href="establish_bgp_session.html">Establishing a BGP session</a></span></li><li tabindex="2"><span class="file"><a href="bgp_failover.html">BGP failover configuration on a BGP peer</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="static_setup.html">Static Setup</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="authentication_and_authorization.html">2. Authentication and authorization</a></span><ul><li tabindex="2"><span class="file"><a href="authentication_services.html">Available authentication services in MidoNet</a></span><ul><li tabindex="2"><span class="file"><a href="authentication_services.html#_keystone_specific_configurations">Keystone-specific configurations</a></span></li><li tabindex="2"><span class="file"><a href="authentication_services.html#_about_mock_authentication">About mock authentication</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="authentication_roles.html">Roles in MidoNet</a></span><ul><li tabindex="2"><span class="file"><a href="authentication_roles.html#_creating_admin_roles_for_midonet">Creating admin roles for MidoNet</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="keystone_authentication.html">Using the Keystone authentication service</a></span><ul><li tabindex="2"><span class="file"><a href="enabling_keystone_authentication.html">Enabling Keystone authentication</a></span><ul><li tabindex="2"><span class="file"><a href="enabling_keystone_authentication.html#_auth_auth_provider">auth-auth_provider</a></span></li><li tabindex="2"><span class="file"><a href="enabling_keystone_authentication.html#_keystone_service_protocol">keystone-service_protocol</a></span></li><li tabindex="2"><span class="file"><a href="enabling_keystone_authentication.html#_keystone_service_host">keystone-service_host</a></span></li><li tabindex="2"><span class="file"><a href="enabling_keystone_authentication.html#_keystone_service_port">keystone-service_port</a></span></li><li tabindex="2"><span class="file"><a href="enabling_keystone_authentication.html#_keystone_admin_token">keystone-admin_token</a></span></li><li tabindex="2"><span class="file"><a href="enabling_keystone_authentication.html#_auth_admin_role">auth-admin_role</a></span></li><li tabindex="2"><span class="file"><a href="enabling_keystone_authentication.html#_keystone_tenant_name">keystone-tenant_name</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="disabling_keystone_authentication.html">Disabling Keystone authentication</a></span><ul><li tabindex="2"><span class="file"><a href="disabling_keystone_authentication.html#_auth_auth_provider_2">auth-auth_provider</a></span></li><li tabindex="2"><span class="file"><a href="disabling_keystone_authentication.html#_mock_auth_admin_token">mock_auth-admin_token</a></span></li><li tabindex="2"><span class="file"><a href="disabling_keystone_authentication.html#_mock_auth_tenant_admin_token">mock_auth-tenant_admin_token</a></span></li><li tabindex="2"><span class="file"><a href="disabling_keystone_authentication.html#_mock_auth_tenant_user_token">mock_auth-tenant_user_token</a></span></li></ul></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="admitting_resources.html">3. Admitting resources to MidoNet</a></span><ul><li tabindex="2"><span class="file"><a href="tunnel_zones.html">What are tunnel zones?</a></span><ul><li tabindex="2"><span class="file"><a href="_creating_tunnel_zones.html">Creating tunnel zones</a></span></li><li tabindex="2"><span class="file"><a href="deleting_tunnel_zones.html">Deleting tunnel zones</a></span></li><li tabindex="2"><span class="file"><a href="viewing_tunnel_zone_information.html">Viewing tunnel zone information</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="working_with_hosts.html">Working with hosts</a></span><ul><li tabindex="2"><span class="file"><a href="viewing_host_information.html">Viewing host information</a></span></li><li tabindex="2"><span class="file"><a href="admitting_a_host.html">Admitting a host</a></span></li><li tabindex="2"><span class="file"><a href="removing_a_host_from_a_tunnel_zone.html">Removing a host from a tunnel zone</a></span></li><li tabindex="2"><span class="file"><a href="removing_a_host.html">Removing a host</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="device_abstractions.html">4. Device abstractions</a></span><ul><li tabindex="2"><span class="file"><a href="creating_a_router.html">Creating a router</a></span></li><li tabindex="2"><span class="file"><a href="adding_a_port_to_a_router.html">Adding a port to a router</a></span></li><li tabindex="2"><span class="file"><a href="adding_a_bridge.html">Adding a bridge</a></span></li><li tabindex="2"><span class="file"><a href="adding_a_port_to_a_bridge.html">Adding a port to a bridge</a></span></li><li tabindex="2"><span class="file"><a href="binding_an_exterior_port_to_a_host.html">Binding an exterior port to a host</a></span></li><li tabindex="2"><span class="file"><a href="stateful_port_groups.html">Stateful port groups</a></span><ul><li tabindex="2"><span class="file"><a href="_creating_stateful_port_groups.html">Creating stateful port groups</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="connecting_devices.html">5. Connecting devices</a></span><ul><li tabindex="2"><span class="file"><a href="concept_i13_q4d_q4.html">Connecting a bridge to a router</a></span></li><li tabindex="2"><span class="file"><a href="concept_cpk_t4d_q4.html">Connecting two routers</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="routing.html">6. Routing</a></span><ul><li tabindex="2"><span class="file"><a href="routing_process_overview.html">Routing process overview</a></span><ul><li tabindex="2"><span class="file"><a href="routing_process_overview.html#_source">Source</a></span></li><li tabindex="2"><span class="file"><a href="routing_process_overview.html#_type">Type</a></span></li><li tabindex="2"><span class="file"><a href="routing_process_overview.html#_destination">Destination</a></span></li><li tabindex="2"><span class="file"><a href="routing_process_overview.html#_next_hop_gateway">Next Hop Gateway</a></span></li><li tabindex="2"><span class="file"><a href="routing_process_overview.html#_next_hop_port">Next Hop Port</a></span></li><li tabindex="2"><span class="file"><a href="routing_process_overview.html#_weight">Weight</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="viewing_routes.html">Viewing routes</a></span></li><li tabindex="2"><span class="file"><a href="concept_e3j_tpd_q4.html">Working with the Provider Router</a></span></li><li tabindex="2"><span class="file"><a href="adding_routes.html">Adding routes</a></span></li><li tabindex="2"><span class="file"><a href="deleting_routes.html">Deleting routes</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="rule_chains.html">7. Rule chains</a></span><ul><li tabindex="2"><span class="file"><a href="packet_flow_within_router.html">A packet’s flow within a router</a></span></li><li tabindex="2"><span class="file"><a href="packet_flow_within_rule_chain.html">A packet’s flow within a rule chain</a></span></li><li tabindex="2"><span class="file"><a href="rule_types.html">Rule types</a></span><ul><li tabindex="2"><span class="file"><a href="rule_types.html#_accept_drop_reject_return">ACCEPT, DROP, REJECT, RETURN</a></span></li><li tabindex="2"><span class="file"><a href="rule_types.html#_dnat_snat">DNAT, SNAT</a></span></li><li tabindex="2"><span class="file"><a href="rule_types.html#_rev_dnat_rev_snat">REV_DNAT, REV_SNAT</a></span></li><li tabindex="2"><span class="file"><a href="rule_types.html#_jump">Jump</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="rule_order.html">Rule order</a></span></li><li tabindex="2"><span class="file"><a href="rule_conditions.html">Rule conditions</a></span><ul><li tabindex="2"><span class="file"><a href="example_condition_1.html">Example condition 1</a></span></li><li tabindex="2"><span class="file"><a href="example_condition_2.html">Example condition 2</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="midonet_rule_chain_example.html">MidoNet rule chain example</a></span><ul><li tabindex="2"><span class="file"><a href="midonet_rule_chain_example.html#_assumptions">Assumptions</a></span></li><li tabindex="2"><span class="file"><a href="midonet_rule_chain_example.html#_listing_the_bridges_for_the_tenant">Listing the Bridges for the Tenant</a></span></li><li tabindex="2"><span class="file"><a href="midonet_rule_chain_example.html#_listing_the_ports_on_the_bridge">Listing the Ports on the Bridge</a></span></li><li tabindex="2"><span class="file"><a href="midonet_rule_chain_example.html#_listing_the_rules_for_the_inbound_chain_on_a_port">Listing the Rules for the Inbound Chain on a Port</a></span></li><li tabindex="2"><span class="file"><a href="midonet_rule_chain_example.html#_listing_the_openstack_security_group_rule_chain">Listing the OpenStack Security Group Rule Chain</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="listing_the_bridges_for_the_tenant.html">Listing the bridges for the tenant</a></span><ul><li tabindex="2"><span class="file"><a href="listing_the_bridges_for_the_tenant.html#_listing_the_ports_on_the_bridge_2">Listing the ports on the bridge</a></span></li><li tabindex="2"><span class="file"><a href="listing_the_bridges_for_the_tenant.html#_listing_the_rules_for_the_pre_routing_rule_chain">Listing the rules for the pre-routing rule chain</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="listing_the_openstack_security_group_rule_chain.html">Listing the OpenStack security group rule chain</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="network_address_translation.html">8. Network Address Translation</a></span><ul><li tabindex="2"><span class="file"><a href="static_nat.html">Static NAT</a></span><ul><li tabindex="2"><span class="file"><a href="static_nat.html#_assumptions_2">Assumptions</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="nat_rule_chains.html">Viewing NAT rule chain information</a></span><ul><li tabindex="2"><span class="file"><a href="nat_rule_chains.html#_assumptions_3">Assumptions</a></span></li><li tabindex="2"><span class="file"><a href="nat_rule_chains.html#_viewing_a_pre_routing_rule">Viewing a Pre-Routing rule</a></span></li><li tabindex="2"><span class="file"><a href="nat_rule_chains.html#_viewing_a_post_routing_rule">Viewing a Post-Routing rule</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="snat_dnat_revdnat.html">Configuring SNAT, DNAT, and REV_DNAT</a></span></li><li tabindex="2"><span class="file"><a href="dnat_revdnat_example.html">DNAT/REV_DNAT example</a></span></li><li tabindex="2"><span class="file"><a href="snat_example.html">SNAT example</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="l4lb.html">9. Layer 4 Load Balancing</a></span><ul><li tabindex="2"><span class="file"><a href="l4lb_configuration.html">Load balancer configuration</a></span></li><li tabindex="2"><span class="file"><a href="sticky_source_ip.html">Sticky source IP</a></span></li><li tabindex="2"><span class="file"><a href="health_monitor.html">Health monitor</a></span><ul><li tabindex="2"><span class="file"><a href="_haproxy_configuration.html">HAProxy configuration</a></span></li><li tabindex="2"><span class="file"><a href="_enabling_health_monitoring_in_a_pool.html">Enabling Health Monitoring in a Pool</a></span></li><li tabindex="2"><span class="file"><a href="_disabling_health_monitoring.html">Disabling Health Monitoring</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="l2_address_masking.html">10. L2 address masking</a></span><ul><li tabindex="2"><span class="file"><a href="rule_chain_example.html">L2 address mask rule chain example</a></span></li></ul></li><li tabindex="2" id="webhelp-currentid"><span class="file"><a href="handling_fragmented_packets.html">11. Handling fragmented packets</a></span><ul><li tabindex="2"><span class="file"><a href="handling_fragmented_packets.html#_definitions_and_allowed_values">Definitions and allowed values</a></span></li><li tabindex="2"><span class="file"><a href="handling_fragmented_packets.html#_fragmented_packets_rule_chain_creation_example">Fragmented packets rule chain creation example</a></span></li><li tabindex="2"><span class="file"><a href="handling_fragmented_packets.html#_non_fragmented_and_fragmented_packets">Non-Fragmented and Fragmented Packets</a></span></li><li tabindex="2"><span class="file"><a href="handling_fragmented_packets.html#_fragmented_and_non_fragmented_packets_with_different_destinations">Fragmented and Non-Fragmented Packets with Different Destinations</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="resource_protection.html">12. MidoNet resource protection</a></span><ul><li tabindex="2"><span class="file"><a href="resource_protection.html#_introduction">Introduction</a></span></li><li tabindex="2"><span class="file"><a href="resource_protection.html#_expected_behavior">Expected Behavior</a></span></li><li tabindex="2"><span class="file"><a href="resource_protection.html#_configuration">Configuration</a></span></li><li tabindex="2"><span class="file"><a href="resource_protection.html#_disabling_resource_protection">Disabling Resource Protection</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="monitoring.html">13. MidoNet monitoring</a></span><ul><li tabindex="2"><span class="file"><a href="metering.html">Metering</a></span><ul><li tabindex="2"><span class="file"><a href="metering.html#_overview">Overview</a></span></li><li tabindex="2"><span class="file"><a href="metering.html#_querying_meters">Querying meters</a></span></li><li tabindex="2"><span class="file"><a href="metering.html#_creating_a_custom_meter">Creating a custom meter</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="munin.html">Monitoring with Munin</a></span><ul><li tabindex="2"><span class="file"><a href="_configuring_munin.html">Configuring Munin</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="zabbix.html">Monitoring with Zabbix</a></span></li><li tabindex="2"><span class="file"><a href="nsdb.html">Monitoring Network State Database</a></span><ul><li tabindex="2"><span class="file"><a href="cassandra.html">Cassandra</a></span></li><li tabindex="2"><span class="file"><a href="zookeeper.html">ZooKeeper</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="midolman.html">Monitoring Midolman Agents</a></span></li><li tabindex="2"><span class="file"><a href="events.html">Monitoring events</a></span><ul><li tabindex="2"><span class="file"><a href="configuration.html">Configuration</a></span></li><li tabindex="2"><span class="file"><a href="log_file_locations.html">Event log files locations</a></span></li><li tabindex="2"><span class="file"><a href="message_format.html">Message format</a></span></li><li tabindex="2"><span class="file"><a href="message_categories.html">List of event messages</a></span><ul><li tabindex="2"><span class="file"><a href="topology_events.html">Virtual topology events</a></span><ul><li tabindex="2"><span class="file"><a href="topology_events.html#_router">Router</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_bridge">Bridge</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_port">Port</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_chain">Chain</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_rule">Rule</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_tunnel_zone">Tunnel Zone</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_bgp">BGP</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_loadbalancer">LoadBalancer</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_vip">VIP</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_pool">Pool</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_poolmember">PoolMember</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_healthmonitor">HealthMonitor</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="api_server_events.html">API server events</a></span><ul><li tabindex="2"><span class="file"><a href="api_server_events.html#_nsdb_network_state_database">NSDB (Network State Database)</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="midolman_events.html">MidoNet Agent events</a></span><ul><li tabindex="2"><span class="file"><a href="midolman_events.html#_nsdb">NSDB</a></span></li><li tabindex="2"><span class="file"><a href="midolman_events.html#_interface">Interface</a></span></li><li tabindex="2"><span class="file"><a href="midolman_events.html#_service">Service</a></span></li></ul></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="packet_tracing.html">Packet Tracing</a></span><ul><li tabindex="2"><span class="file"><a href="packet_tracing.html#_usage">Usage</a></span></li><li tabindex="2"><span class="file"><a href="packet_tracing.html#_example">Example</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="vxlan_configuration.html">14. VXLAN configuration</a></span><ul><li tabindex="2"><span class="file"><a href="vxlan_gateway.html">VXLAN Gateway</a></span></li><li tabindex="2"><span class="file"><a href="vxlan_coordinator.html">VXLAN Coordinator</a></span></li><li tabindex="2"><span class="file"><a href="connect_to_vtep.html">Connecting to the VTEP</a></span></li><li tabindex="2"><span class="file"><a href="connect_vtep_to_neutron.html">Setting up a connection between a VTEP and a Neutron network</a></span></li><li tabindex="2"><span class="file"><a href="connect_vtep_to_midonet.html">Enabling connection between VTEP and MidoNet hosts</a></span></li><li tabindex="2"><span class="file"><a href="vxgw_troubleshooting.html">Troubleshooting VTEP/VXGW configuration</a></span></li><li tabindex="2"><span class="file"><a href="vxlan_cli_commands.html">CLI commands used for working with the VXGW</a></span><ul><li tabindex="2"><span class="file"><a href="cli_list_vteps.html">Obtaining a list of VTEPs</a></span></li><li tabindex="2"><span class="file"><a href="cli_add_vtep.html">Adding a VTEP</a></span></li><li tabindex="2"><span class="file"><a href="cli_show_vtep.html">Obtaining information about a VTEP</a></span></li><li tabindex="2"><span class="file"><a href="cli_add_vtep_binding.html">Adding a VTEP binding</a></span></li><li tabindex="2"><span class="file"><a href="cli_list_vtep_bindings.html">Obtaining descriptions of VTEP bindings</a></span></li><li tabindex="2"><span class="file"><a href="cli_remove_vtep_binding.html">Removing a VTEP binding</a></span></li><li tabindex="2"><span class="file"><a href="cli_delete_vtep.html">Deleting a VTEP</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="l2_gateway.html">15. Setting up an L2 gateway</a></span><ul><li tabindex="2"><span class="file"><a href="l2_gateway_configuration.html">Configuring an L2 gateway</a></span></li><li tabindex="2"><span class="file"><a href="l2_gateway_failover.html">Fail-over/Fail-back</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="mn_cli.html">16. Working with the MidoNet CLI</a></span><ul><li tabindex="2"><span class="file"><a href="mn_cli_usage.html">Using the MidoNet CLI</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="advanced_configuration_and_concepts.html">17. Advanced configuration and concepts</a></span><ul><li tabindex="2"><span class="file"><a href="midonet_config.html">MidoNet Configuration: mn-conf(1)</a></span><ul><li tabindex="2"><span class="file"><a href="_bootstrapping.html">Bootstrapping</a></span></li><li tabindex="2"><span class="file"><a href="_configuration_sources.html">Configuration sources</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="recommended_configurations.html">Recommended configurations</a></span><ul><li tabindex="2"><span class="file"><a href="recommended_configurations.html#_overview_of_performance_impacting_configuration_options">Overview of Performance-Impacting Configuration Options</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="midolman_configuration_options.html">MidoNet Agent (Midolman) configuration options</a></span><ul><li tabindex="2"><span class="file"><a href="midolman_configuration_options.html#_midonet_behavior_after_zookeeper_cluster_failure">MidoNet behavior after ZooKeeper cluster failure</a></span></li><li tabindex="2"><span class="file"><a href="midolman_configuration_options.html#_zookeeper_configuration">ZooKeeper configuration</a></span></li><li tabindex="2"><span class="file"><a href="midolman_configuration_options.html#_cassandra_configuration">Cassandra configuration</a></span></li><li tabindex="2"><span class="file"><a href="midolman_configuration_options.html#_midonet_agent_datapath_configuration">MidoNet Agent datapath configuration</a></span></li><li tabindex="2"><span class="file"><a href="midolman_configuration_options.html#_bgp_failover_configuration">BGP failover configuration</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="appi_configuration_options.html">Advanced MidoNet API configuration options</a></span><ul><li tabindex="2"><span class="file"><a href="appi_configuration_options.html#_rest_api_base_uri">rest_api-base_uri</a></span></li><li tabindex="2"><span class="file"><a href="appi_configuration_options.html#_cors_access_control_allow_origin">cors-access_control_allow_origin</a></span></li><li tabindex="2"><span class="file"><a href="appi_configuration_options.html#_cors_access_control_allow_headers">cors-access_control_allow_headers</a></span></li><li tabindex="2"><span class="file"><a href="appi_configuration_options.html#_cors_access_control_allow_methods">cors-access_control_allow_methods</a></span></li><li tabindex="2"><span class="file"><a href="appi_configuration_options.html#_cors_access_control_expose_headers">cors-access_control_expose_headers</a></span></li><li tabindex="2"><span class="file"><a href="appi_configuration_options.html#_auth_tenant_admin_role">auth-tenant_admin_role</a></span></li><li tabindex="2"><span class="file"><a href="appi_configuration_options.html#_auth_tenant_user_role">auth-tenant_user_role</a></span></li><li tabindex="2"><span class="file"><a href="appi_configuration_options.html#_zookeeper_use_mock">zookeeper-use_mock</a></span></li><li tabindex="2"><span class="file"><a href="appi_configuration_options.html#_zookeeper_midolman_root_key">zookeeper-midolman_root_key</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="cassandra_cache.html">Cassandra cache</a></span><ul><li tabindex="2"><span class="file"><a href="midolman_behavior_on_cassandra_failure.html">Agent behavior on node failure</a></span></li><li tabindex="2"><span class="file"><a href="nsdb_connectivity.html">Network State Database connectivity</a></span><ul><li tabindex="2"><span class="file"><a href="nsdb_connectivity.html#_zookeeper_zookeeper_hosts">zookeeper-zookeeper_hosts</a></span></li><li tabindex="2"><span class="file"><a href="nsdb_connectivity.html#_zookeeper_session_timeout">zookeeper-session_timeout</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="improve_tomcat_startup.html">Improving Tomcat startup time</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="service_ports.html">18. MidoNet and OpenStack TCP/UDP service ports</a></span><ul><li tabindex="2"><span class="file"><a href="controller_node_services.html">Services on the Controller node</a></span></li><li tabindex="2"><span class="file"><a href="nsdb_node_services.html">Services on the Network State Database nodes</a></span></li><li tabindex="2"><span class="file"><a href="compute_node_services.html">Services on the Compute nodes</a></span></li><li tabindex="2"><span class="file"><a href="gateway_node_services.html">Services on the Gateway Nodes</a></span></li></ul></li></ul></div></div><div id="searchDiv"><div id="search"><form onsubmit="Verifie(ditaSearch_Form);return false" name="ditaSearch_Form" class="searchForm"><fieldset class="searchFieldSet"><legend>Search</legend><center><input id="textToSearch" name="textToSearch" type="text" class="searchText"/> &nbsp; <input onclick="Verifie(ditaSearch_Form)" type="button" class="searchButton" value="Go" id="doSearch"/></center></fieldset></form></div><div id="searchResults"><center/></div><p class="searchHighlight"><a href="#" onclick="toggleHighlight()">Search Highlighter (On/Off)</a></p></div></div></div></div></body></html>